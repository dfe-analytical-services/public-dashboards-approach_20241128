<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.39">

  <meta name="author" content="Cam Race">
  <title>Our accessible statistics services journey</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto-3751999ecd1d1570c6c6a596c8503346.css">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="images/sanctuary-buildings.jpg" data-background-opacity="0.1" data-background-position="top" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title">Our accessible statistics services journey</h1>
  <p class="subtitle">Explore education statistics platforms</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Cam Race 
</div>
        <p class="quarto-title-affiliation">
            Department for Education
          </p>
    </div>
</div>

</section>
<section id="introduction" class="slide level2">
<h2>Introduction</h2>
<ul>
<li class="fragment"><p>Badged statistician, turned product manager for explore education statistics (EES)</p></li>
<li class="fragment"><p>Share our journey of creating useable and accessible dashboards and data visualisations for DfE</p></li>
<li class="fragment"><p>In particular</p>
<ul>
<li class="fragment">who we are, what we do</li>
<li class="fragment">the processes we use to publish dashboards alongside EES</li>
<li class="fragment">what software we use</li>
<li class="fragment">guidance and templates</li>
<li class="fragment">how we check for accessibility</li>
<li class="fragment">our attempts (so far) to bridge the gap between analysis and digital</li>
</ul></li>
</ul>
</section>
<section id="dfe-statistics-services-unit-ssu" class="slide level2">
<h2>DfE Statistics Services Unit (SSU)</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>A small central resource providing advice and support to statisticians and those working with statistics across the department.</p>
<p>We aim to raise standards and build capability - empowering our statisticians to develop themselves, their processes, and their products in line with the pillars of the code of practice for official statistics.</p>
<p>We maintain several resources and tools to support DfE statisticians in their work.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<figcaption>Our team mascot - Frederick:</figcaption>
<p><img data-src="images/duckWaddle.gif" style="width:50.0%"></p>
</figure>
</div>
</div><div class="column fragment" style="width:60%;">
<p>SSU is made up of four teams:</p>
<div class="box">
<ul>
<li class="fragment"><p><strong>Statistics Head of Profession Office</strong></p>
<p>Supports statistics processes and best practice in line with the GSS Code of Practice. Lead on supporting the statistics community.</p></li>
</ul>
</div>
<div class="box">
<ul>
<li class="fragment"><p><strong>Statistics Development Team</strong></p>
<p>Provide learning and development support for analysts, lead on Reproducible Analytical Pipelines (RAP).</p></li>
</ul>
</div>
<div class="box">
<ul>
<li class="fragment"><p><strong>Compare School and College Performance</strong></p>
<p>Product ownership for Compare School and College Performance</p></li>
</ul>
</div>
<div class="box">
<ul>
<li class="fragment"><p><strong>Explore education statistics platforms</strong></p>
<p>Dedicated digital support to all statisticians and analysts publishing data publicly, leading the development of the explore education statistics (EES) service and public facing dashboards.</p>
<ul>
<li class="fragment">1x Statistician G7 (turned Product Owner)</li>
<li class="fragment">1x Statistician SEO</li>
<li class="fragment">Contract in a small development team who’ve built and maintained the core EES website</li>
<li class="fragment">Have a contractor in building new hosting servers in Azure for public dashboards</li>
</ul></li>
</ul>
</div>
</div></div>
</section>
<section id="the-work-of-ssu" class="slide level2">
<h2>The work of SSU</h2>
<div class="columns">
<div class="column fragment">
<p>Our objectives:</p>
<ul>
<li class="fragment"><p><strong>Platforms</strong></p>
<p>We maintain, enhance, and maximize the use of cutting-edge platforms for external data dissemination.</p></li>
<li class="fragment"><p><strong>Standards</strong></p>
<p>We maintain guidance, communicate standards, and facilitate a culture of continuous improvement.</p></li>
<li class="fragment"><p><strong>Internal impact</strong></p>
<p>We continuously engage with our internal stakeholders as a point of contact for all things statistics. We work with comms and private offices to ensure our statistics are impactful and handled correctly within the organization.</p></li>
<li class="fragment"><p><strong>Skills</strong></p>
<p>We support teams to build the skills they need to meet best practice standards</p></li>
<li class="fragment"><p><strong>Community</strong></p>
<p>We invest in our community to make sure it’s a great place to work and develop, providing professional support and advice to statisticians in DfE and building an engaged GSS community.</p></li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<figcaption>SSU support offer poster:</figcaption>
<p><img data-src="ssu-support.svg" style="width:60.0%"></p>
</figure>
</div>
</div></div>
</section>
<section>
<section id="explore-education-statistics" class="title-slide slide level1 center">
<h1>Explore education statistics</h1>

</section>
<section id="a-quick-h-ees-tory" class="slide level2">
<h2>A quick h-EES-tory</h2>
<div class="fragment">
<p>Began in 2018, with user research to understand the needs of both producers and users of published education statistics <a href="https://assets.publishing.service.gov.uk/media/5b3b395ded915d33d657a129/HiveIT_-_DfE_dissemination_discovery.pdf">(public discovery report)</a>.</p>
</div>
<div class="fragment">
<p>That research identified two priorities:</p>
<ul>
<li class="fragment"><p>We needed a more flexible, modern statistics publishing service to better support what our users need and the department’s statistics function.</p></li>
<li class="fragment"><p>To continue to implement Reproducible Analytical Pipelines (RAP), and move to a single consistent open data standard underpinning all of our statistics releases, making all of our public data machine readable, our production more efficient, and upskilling staff to use R and Git.</p></li>
</ul>
</div>
<div class="fragment">
<p>Following that we decided to break away from GOV.UK and instead build a bespoke .service.gov.uk (EES), using C# / .NET and Typescript / React, our <a href="https://github.com/dfe-analytical-services/explore-education-statistics">source code is availble on GitHub</a>.</p>
<p>We’ve taken the service through the Alpha and Private Beta digital delivery phases, developing the platform’s functionality in line with user feedback.</p>
</div>
<div class="fragment">
<p>In tandem to the EES development we worked on establishing a consistent open data structure with plans to use the launch of the service to embed and facilitate basic use of RAP at scale.</p>
</div>
<div class="fragment">
<p>In March 2020 we launched EES as a Public Beta Service and it has been our default route for statistics publishing ever since (replacing the previous method of publishing static documents on GOV.UK).</p>
</div>
<div class="fragment">
<p>During the pandemic, demand for dashboards boomed, and we have been expanding our service offering to also provide public hosting for R Shiny dashboards to complement our main EES service.</p>
</div>
<div class="fragment">
<p>We’ve been committed to further enhancing the core EES service in line with user needs since launch, our current development focus is adding stable API access to data published on the service.</p>
</div>
<div class="fragment">
<blockquote>
<p>A platform built by statisticians, for statisticians.</p>
</blockquote>
</div>
</section>
<section id="what-is-ees" class="slide level2">
<h2>What is EES?</h2>
<p>Our product vision for the core EES website is:</p>
<blockquote>
<p>Make it easier to publish engaging education statistics that all users can find, navigate, interact with and take away.</p>
</blockquote>
<div class="fragment">
<p>It is a service with two parts - admin and public facing websites.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/ees_diagram.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div>
</section>
<section id="consistent-open-data" class="slide level2">
<h2>Consistent open data</h2>
<div class="columns">
<div class="column fragment" style="width:60%;">
<p>Our consistent, machine readable open data is where the real power of the service lies.</p>
<p>Poor consistency is a regular criticism we have heard from users and focusing on delivering comprehensive machine readable data with a query tool on top has helped us focus our automation efforts to the area with the most gain.</p>
</div><div class="column fragment" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<figcaption>Consistent open data standards</figcaption>
<p><img data-src="images/data-format.png"></p>
</figure>
</div>
</div></div>
<div class="columns">
<div class="column fragment" style="width:60%;">
<p>Consistency is ensured by use of our “<a href="https://github.com/dfe-analytical-services/dfe-published-data-qa"><strong>Data Screener</strong></a>” App, which allows teams to independently test their datasets.</p>
<p>It runs automated tests against formatting best practice and data harmonisation rules (e.g.&nbsp;consistent labels for key variables) and provides quick feedback and guidance where files fail.</p>
</div><div class="column fragment" style="width:40%;">
<p><img data-src="images/data-screener.png"></p>
</div></div>
<div class="fragment">
<p>Extensive guidance is made available to analysts via our <a href="https://dfe-analytical-services.github.io/analysts-guide/statistics-production/ud.html">analysts guide</a>.</p>
</div>
</section>
<section id="ees-admin" class="slide level2">
<h2>EES admin</h2>
<p>A secure environment with publication and release based permission levels. Includes secure 24 hour pre-release access outside of DfE too.</p>
<h3 id="data-upload-and-consistent-surfacing">Data upload and consistent surfacing</h3>
<div class="columns">
<div class="column" style="width:40%;">
<p>The presentation of data items is powered from initial data and metadata upload. Including labeling, ordering and rule-based footnotes.</p>
<p>We have a simple data replacement feature that allows you to swap in similar data files without having to recreate charts or tables.</p>
</div><div class="column" style="width:60%;">
<p><img data-src="images/admin-uploaded-data.png"></p>
</div></div>
</section>
<section id="ees-admin-1" class="slide level2">
<h2>EES admin</h2>
<h3 id="release-editor">Release editor</h3>
<div class="columns">
<div class="column" style="width:40%;">
<p>A content editor to create their release content, combining text blocks and data blocks into a HTML release page.</p>
<p>Admin users are able to comment on content and style within a range of allow options.</p>
<div class="fragment">
<p>In recent months we’ve made some powerful tweaks:</p>
<ul>
<li class="fragment"><p>removed italics from being an option and stripped all italics out of old content through automatic sanitisation</p></li>
<li class="fragment"><p>we’ve built in automatic accessibility checks to prevent common content isuses (e.g.&nbsp;<a href="https://github.com/dfe-analytical-services/dfeshiny/blob/main/data-raw/bad_link_text.R">poor link text</a>, missing alt text, using bold instead of headers and illogical header ordering)</p></li>
<li class="fragment"><p>the editor shows errors and prevents saving if any issues are present, a hard and strict line to prevent any issues in new content</p></li>
<li class="fragment"><p>found it gives publishers the information and guidance right at the point where it’s most relevant</p></li>
<li class="fragment"><p>so far proving much more effective than upskilling / best practice sharing we’d been doing previously</p></li>
</ul>
</div>
</div><div class="column" style="width:60%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/admin-editor.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div></div>
</section>
<section id="ees-admin-2" class="slide level2">
<h2>EES admin</h2>
<h3 id="autonomous-scheduling">Autonomous scheduling</h3>
<div class="columns">
<div class="column" style="width:40%;">
<p>An autonomous publishing process, allows for efficient sign off and scheduling. Publications can be created and published quickly.</p>
<p>We have also integrated a release sign off checklist to catch some of the regular things our teams may forget to address.</p>
</div><div class="column" style="width:60%;">
<p><img data-src="images/admin-sign-off.png"></p>
</div></div>
</section>
<section id="ees-public" class="slide level2">
<h2>EES public</h2>
<h3 id="release-pages">Release pages</h3>
<div class="columns">
<div class="column" style="width:70%;">
<p>Accessible HTML reports (<a href="https://explore-education-statistics.service.gov.uk/find-statistics/suspensions-and-permanent-exclusions-in-england">example</a>) provide users with engaging headline messages, and accordions help users to navigate to the parts of the report they want to see.</p>
<p>There are links to related information and past releases as well as clear feedback routes and ability to subscribe to release notifications.</p>
<p>Users can access glossary entries directly from release pages and embedded charts and tables linked directly to the underpinning datasets enhance the commentary.</p>
<p><img data-src="images/public-release-extras.png"></p>
</div><div class="column" style="width:30%;">
<p><img data-src="images/public-release-page.png"></p>
</div></div>
</section>
<section id="ees-public-1" class="slide level2">
<h2>EES public</h2>
<h3 id="table-tool">Table tool</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>A <a href="https://explore-education-statistics.service.gov.uk/data-tables">step-by-step query tool</a> that sits on top of our large open data files and allows our users to filter down to what they’re interested in.</p>
<p>Once created users can alter the order of their table and download it in either human or machine readable format.</p>
<p>Users can save and share specific tables via our ‘permalink’ feature (<a href="https://explore-education-statistics.service.gov.uk/data-tables/permalink/6ef0d431-7909-45a6-1d5b-08dd0254fb9b">example</a>) which has been helpful for us answering PQs and FOIs.</p>
<p>Footnotes are automatically generated alongside data items in line with the rules statisticians set up within EES admin.</p>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/public-table-tool.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div></div>
</section>
<section id="ees-public-2" class="slide level2">
<h2>EES public</h2>
<h3 id="data-catalogue">Data catalogue</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>A single <a href="https://explore-education-statistics.service.gov.uk/data-catalogue">catalogue</a> for all DfE’s published statistics.</p>
<p>You can filter and preview datasets and we have plans to make this even more useful by adding geographic level and commonly requested variable filters to support speedier access to data sets of interest.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/dataset-preview.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/public-data-catalogue.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</div></div>
</section>
<section id="ees-public-3" class="slide level2">
<h2>EES public</h2>
<h3 id="methodology-pages-and-glossary">Methodology pages and glossary</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>Each publication has a dedicated methodology page (<a href="https://explore-education-statistics.service.gov.uk/methodology/key-stage-2-attainment">example</a>) where we can move a lot of the detailed content that is more suitable to expert users.</p>
<p>We also have a service <a href="https://explore-education-statistics.service.gov.uk/glossary">glossary</a> which collects key terms across the service in one place.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/public-glossary-2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/public-methodology.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</div></div>
</section>
<section id="ees-public-4" class="slide level2">
<h2>EES public</h2>
<p>We’re always iterating, and in general have found user feedback moving us away from accordions, for example on our ‘catalogue’ style pages</p>
<div class="columns">
<div class="column" style="width:&quot;50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/findstatsold.png" class="quarto-figure quarto-figure-center" style="width:65.0%"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/findstatsnew.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div></div>
</section>
<section id="ees-public-5" class="slide level2">
<h2>EES public</h2>
<p>Some of the quick analysis we did at the time on this change</p>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/findstatsanalysis.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</section>
<section id="ees-public-6" class="slide level2">
<h2>EES public</h2>
<p>Further to this, we’ve also been researching and prototyping a new left hand navigation for the service, to help users find their way around the service more easily, and prevent them getting lost within large accordion sections without any indication of their location on the page.</p>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/left_nav_prototype.gif" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
</section>
<section id="accessibility-example-moving-to-wcag-2.2" class="slide level2">
<h2>Accessibility example moving to WCAG 2.2</h2>
<p>One particular change we found was in drag and drop interfaces, it was on our hit list anyway, though with the introduction of WCAG 2.2 it really highlighted an issue we had.</p>
<ul>
<li class="fragment"><p>On the EES service we offer the ability to reorder and customise the locations of table headers and rows in our table tool</p></li>
<li class="fragment"><p>This relied heavily on drag and drop</p></li>
<li class="fragment"><p>We put a good amount of effort into redesigning custom components to allow for accessible routes</p></li>
<li class="fragment"><p>One our proudest moments as a service was during an external accessibility audit watching in person, a keyboard user successfully reorder tables using it and shrug the task off as ‘no problem’!</p></li>
<li class="fragment"><p>Demo use of <a href="https://explore-education-statistics.service.gov.uk/data-tables/graduate-labour-markets/2023?subjectId=2349737f-73cd-433f-4589-08dc8a3f6015">reordering in the table tool</a></p></li>
</ul>
</section>
<section id="use-of-google-analytics" class="slide level2">
<h2>Use of Google Analytics</h2>
<p>Teams automatically get access to a wealth of user analytics to understand how their products are being used.</p>
<p>We have R scripts that connect to the Google analytics API and pull down data, joining with other data sets such as webscrapes of the service, and then storing permanently in our own SQL database on the Analyse and Modelling severs (soon to move to Databricks / Unity Catalog).</p>
<p>We currently share this headline data through our own R Shiny dashboards to analysts in the department (one for EES and one for all supporting dashboards) and provide more detailed information from Google Analytics on request.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-nrow="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<figcaption>User numbers over time</figcaption>
<p><img data-src="images/ga-users-over-time.png"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<figcaption>New users vs established users</figcaption>
<p><img data-src="images/ga-new-vs-established.png"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<figcaption>Where do new users come from</figcaption>
<p><img data-src="images/ga-referrer.png"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<figcaption>Number who used service in past 30 days, 7 days, and 1 day</figcaption>
<p><img data-src="images/ga-repeated-by-day.png"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<p>EES sessions by day since launch:</p>
</div><div class="column" style="width:75%;">
<p><img data-src="images/ees-all-time-sessions.png"></p>
</div></div>
</section>
<section id="use-of-google-analytics-1" class="slide level2">
<h2>Use of Google Analytics</h2>
<p>We encourage our publication teams to make use of the analytics to build an understanding of how their users interact with their product and to inform their future release development.</p>
<p>Google Analytics isn’t perfect, it is reliant on cookie consent and therefore does not represent the whole picture. It has been useful to help us to compare scale across publications and from release to release but we have had frustrations with it.</p>
<p>We have also used Google Analytics to support:</p>
<ul>
<li class="fragment">Monitoring the impact and value of EES feature development. For example, did moving that button over there actually help more people find it?</li>
<li class="fragment">EES service KPIs. Are more users coming to our service from organic routes?</li>
<li class="fragment">A review of DfE’s publication estate and to help make cases for change where we could prune areas our efforts look to not be adding as much value. For example, to support dashboard retirement.</li>
<li class="fragment">To understand usage of our supporting service, like the analysts guide. Are publishers reading the guidance we put out?</li>
</ul>
</section>
<section id="data-visualisation" class="slide level2">
<h2>Data visualisation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>As we’re a central support team for statisticians, we are also the departments representatives on several cross-government groups</p>
<p><a href="https://analysisfunction.civilservice.gov.uk/policy-store/">Analysis Function guidance hub</a></p>
<p><a href="https://analysisfunction.civilservice.gov.uk/area_of_work/data-visualisation/">Data Visualisation guidance</a> - lots and lots here, including free e-learning</p>
<p>We wrote the cross-government <a href="https://analysisfunction.civilservice.gov.uk/policy-store/data-visualisation-colours-in-charts/">colours guidance for use in charts</a></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/choose_own_palette.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/categorical_palette.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</section>
<section id="data-visualisation---choosing-a-chart" class="slide level2">
<h2>Data visualisation - choosing a chart</h2>
<div class="box">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/whatchart.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</section>
<section id="data-visualisation---choosing-a-chart-1" class="slide level2">
<h2>Data visualisation - choosing a chart</h2>
<div class="box">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/whatchart_simple.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
<ul>
<li class="fragment">Keep it simple!</li>
</ul>
</section>
<section id="data-visualisation-1" class="slide level2">
<h2>Data visualisation</h2>
<div class="box">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/default_line_styling.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</div>
</section>
<section id="data-visualisation-2" class="slide level2">
<h2>Data visualisation</h2>
<p>Improved line chart using the afcharts R package (based on the best practice guidance)</p>
<div class="columns">
<div class="column" style="width:60%;">
<div class="box">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/better_line_styling.png" class="quarto-figure quarto-figure-center" style="width:95.0%"></p>
</figure>
</div>
</div>
</div><div class="column" style="width:40%;">
<ul>
<li class="fragment"><p>removed grey background</p></li>
<li class="fragment"><p>fewer gridlines</p></li>
<li class="fragment"><p>used the af colours</p></li>
<li class="fragment"><p>labelled lines directly to reduce reliance on colour (text should be bigger or black for better contrast)</p></li>
</ul>
</div></div>
</section>
<section id="data-visualisation-3" class="slide level2">
<h2>Data visualisation</h2>
<p>Usually, less is more, keep it simple to make it effective</p>
<p>Never release data in a chart only - always have a table equivalent</p>
<ul>
<li class="fragment"><p>Provide an accessible route</p></li>
<li class="fragment"><p>Makes it easier to take the data away if reusing elsewhere</p></li>
<li class="fragment"><p>Some users also just prefer a table!</p></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">

</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/ees_chart_table.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/ees_tab_chart.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div></div>
</section></section>
<section>
<section id="how-do-dashboards-fit-in" class="title-slide slide level1 center">
<h1>How do dashboards fit in?</h1>

</section>
<section id="ees-dashboards-and-other-services" class="slide level2">
<h2>EES, dashboards and other services</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>EES is our primary dissemination route and gives us a core service for transparent public facing statistics.</p>
<p>We tried to build it in a way that would work well with other secondary services that support more specific user needs or behaviors. These can often make use of the same data sources and our aim is to reduce data duplication and make our processes more efficient via use of APIs.</p>
<blockquote>
<p>Our aim is to do transparency once, and feed everything else from there</p>
</blockquote>
<p>These secondary services could be R Shiny dashboards or tailored digital services (e.g.&nbsp;<a href="https://www.compare-school-performance.service.gov.uk/">Compare School and College Performance</a>).</p>
<p>We have developed our use of R Shiny significantly over recent years as demand has grown, and have created supporting materials:</p>
<ul>
<li class="fragment"><a href="https://github.com/dfe-analytical-services/shiny-template">DfE Shiny template</a></li>
<li class="fragment"><a href="https://dfe-analytical-services.github.io/analysts-guide/writing-visualising/dashboards.html">DfE dashboards guidance</a></li>
<li class="fragment"><a href="https://github.com/dfe-analytical-services/dfeshiny">dfeshiny</a> R package (to complement our use of <a href="https://github.com/moj-analytical-services/shinyGovstyle">shinyGovstyle</a>)</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/ees-system.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</section>
<section id="dashboards" class="slide level2">
<h2>Dashboards</h2>
<div class="fragment">
<p>What is a dashboard?</p>
</div>
<ul>
<li class="fragment"><p>Something visual, that can be regularly refreshed with new data for minimal effort</p></li>
<li class="fragment"><p>Sometimes a way to provide specific interactivity for users</p></li>
<li class="fragment"><p>Effectively a mini / lightweight digital service, often made by analysts or data scientists</p></li>
<li class="fragment"><p>Are an excellent route for prototyping new features for larger services like the main EES website, analysts can make interactive visualisations in a fraction of the time that software engineers can as tools like R Shiny are designed for this purpose</p></li>
</ul>
<div class="fragment">
<p>This is where the fun comes in, as analysts rarely have experience of digital services…</p>
</div>
</section>
<section id="dashboards-1" class="slide level2">
<h2>Dashboards</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>We provide the publishing platform and act as the gatekeepers (noone can publish R Shiny publicly without us)</p>
<ul>
<li class="fragment"><p>We currently have around 20 public facing dashboards in R Shiny</p></li>
<li class="fragment"><p>Some dashboards focus in on a specific data set (e.g.&nbsp;attendance)</p></li>
<li class="fragment"><p>Others are a summary / compendium across an area (e.g.&nbsp;Children’s Social Care)</p></li>
<li class="fragment"><p>Some are interactive replacements for previous Excel tools (e.g.&nbsp;LAIT)</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="images/apps.png" style="width:80.0%"> <img data-src="images/lait.png" style="width:80.0%"></p>
</div></div>
</section>
<section id="dashboard-process-diagram" class="slide level2">
<h2>Dashboard process diagram</h2>
<p>Existing data can come from multiple sources, EES, other sources in the department, or even outside of the department.</p>
<div class="box">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/dashboard_updates.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</section>
<section id="dashboard-parts-diagram" class="slide level2">
<h2>Dashboard parts diagram</h2>
<div class="box">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/dashboard_parts.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</section>
<section id="what-is-r-shiny" class="slide level2">
<h2>What is R Shiny?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/r.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/rshiny.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
<ul>
<li class="fragment"><p>Firstly, R itself is an open source programming language designed for statistical computing and data visualisation</p></li>
<li class="fragment"><p>R Shiny is a framework for building <a href="https://developer.mozilla.org/en-US/docs/Glossary/SPA">single page web applications</a> using R</p></li>
<li class="fragment"><p>It is fully extensible using JavaScript, HTML, and CSS</p></li>
</ul>
</section>
<section id="why-use-r-shiny" class="slide level2">
<h2>Why use R Shiny?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>R is used widely within statisticians and analysts at DfE, as well as across government and in academia</p></li>
<li class="fragment"><p>As it’s open source, it’s free to use, and there’s a wealth of community led, free training and support available</p></li>
<li class="fragment"><p>As it’s open source, we can contribute to and build on what already exists (examples later)</p></li>
<li class="fragment"><p>As it’s just a wrapper on JavaScript, HTML, and CSS, it’s possible to extend and customise, especially important when it comes to styling and accessibility!</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/rstudio.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</section>
<section id="how-have-we-got-here" class="slide level2">
<h2>How have we got here?</h2>
<ul>
<li class="fragment"><p>From 2017 to 2021, we only had a couple of public dashboards at any one time on a subscription to the shinyapps.io service (externally hosted outside of the department), almost no formal support or governance</p></li>
<li class="fragment"><p>A couple of years ago, the demand started to kick in hard (post-pandemic boom)</p></li>
<li class="fragment"><p>Everybody was wanting a ‘dashboard’ - flooding with requests and starting us needing to take it seriously</p></li>
<li class="fragment"><p>We’ve been building a formal strategy and governance / support around it since</p></li>
<li class="fragment"><p>This summer, we split my team in two, separating out some of the statistics specific support so I could dedicate two of us in the unit to our digital dissemination services (EES and dashboards) - bridging that analytical / digital gap</p></li>
<li class="fragment"><p>Currently, we’re the process of formalising our support and guidance to become a more ‘mature’ dashboarding service</p></li>
</ul>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<figcaption>Our first dashboard launched in 2017</figcaption>
<p><img data-src="images/firstdashboard.png" style="width:70.0%"></p>
</figure>
</div>
</div>
</section>
<section id="public-dashboards-guidance" class="slide level2">
<h2>Public dashboards guidance</h2>
<ul>
<li class="fragment"><p>Two parts, <a href="https://dfe-analytical-services.github.io/analysts-guide/writing-visualising/dashboards.html">general for public dashboards</a> and then <a href="https://dfe-analytical-services.github.io/analysts-guide/writing-visualising/dashboards_rshiny.html">R Shiny specific</a></p></li>
<li class="fragment"><p>Built around statistics code of practice and GDS service standard</p></li>
<li class="fragment"><p>All dashboard code must be open-source on our <a href="https://github.com/dfe-analytical-services">dfe-analytical-services GitHub area</a></p></li>
<li class="fragment"><p>Key areas include:</p>
<ul>
<li class="fragment">User needs - always start with why? Could the need be met by an existing service? Does it even need to be a ‘dashboard’?</li>
<li class="fragment">Software - (we have decided to only support R Shiny or Python for public products)</li>
<li class="fragment">Accessibility</li>
<li class="fragment">Consistent styling</li>
<li class="fragment">Performance and quality assurance</li>
<li class="fragment">User engagement and analytics</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:&quot;50%;">
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/dashboards_guidance.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/dashboards_guidance_rshiny.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="r-shiny-template" class="slide level2">
<h2>R Shiny template</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>We have a template R Shiny app, with a number of features and standard things build in.</p>
<ul>
<li class="fragment"><p>template is hosted in GitHub so it can be used to create a new repository from</p></li>
<li class="fragment"><p>has built in pre-commit hooks that prevent accidental committing of unpublished data</p></li>
</ul>
<div class="fragment">
<p>A problem / question we’ve been having a lot recently…</p>
</div>
<ul>
<li class="fragment"><p>Is it a template for a dashboard, or an example of a dashboard, or is it both!</p></li>
<li class="fragment"><p>We want to show example code for as many things as possible to make it easier for analysts to learn and copy</p></li>
<li class="fragment"><p>However, we also often see excess code from the template being left in when reviewing them, as analysts don’t always realise everything they need to delete</p></li>
<li class="fragment"><p>The more examples we add to the template, the more intimidating it becomes and harder it is to use as a starting point</p></li>
<li class="fragment"><p>Particularly found the issue for the README - is it a README for the template, or a template README?</p></li>
<li class="fragment"><p>Our solution is to have both a template README and a README template, and I suspect we’ll be creating a minimal template dashboard and then converting our existing ‘template’ app into a showcase / example app…</p></li>
</ul>
</div><div class="column" style="width:&quot;50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/shinytemplate_github.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/rshinytemplate.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</section>
<section id="dfeshiny-package" class="slide level2">
<h2>dfeshiny package</h2>
<ul>
<li class="fragment"><p>Early this year, we decided to move to building bespoke packages (Software Development Kits / Libraries)</p></li>
<li class="fragment"><p>Like the template, gives a single place for the latest version of the code</p></li>
<li class="fragment"><p>Unlike the template, analysts building dashboards can easily update their package version to get the latest changes!</p></li>
<li class="fragment"><p>Also, another bonus over the template is that we can hide away of a lot of the more complex code inside the package, making it more beginner friendly and reducing the effort required from analysts</p></li>
<li class="fragment"><p>Allows us to make DfE specific components like the header with a DfE logo and link</p></li>
<li class="fragment"><p>We also use it as a testing ground for new common components before moving them into the cross-government shinyGovstyle package</p></li>
</ul>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/dfeshiny.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</div>
</section>
<section id="dfeshiny-package-1" class="slide level2">
<h2>dfeshiny package</h2>
<p>Simple example - created a function for accessible and secure links that open in new tabs, analysts don’t need to worry about the markup, just the content!</p>
<p>Code for the external_link() function</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="co">#' External link</span></span>
<span id="cb1-2"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-3"><a href=""></a><span class="co">#' Intentionally basic wrapper for HTML anchor elements making it easier to</span></span>
<span id="cb1-4"><a href=""></a><span class="co">#' create safe external links with standard and accessible behaviour. For more</span></span>
<span id="cb1-5"><a href=""></a><span class="co">#' information on how the tag is generated, see \code{\link[htmltools]{tags}}.</span></span>
<span id="cb1-6"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-7"><a href=""></a><span class="co">#' @description</span></span>
<span id="cb1-8"><a href=""></a><span class="co">#' It is commonplace for external links to open in a new tab, and when we do</span></span>
<span id="cb1-9"><a href=""></a><span class="co">#' this we should be careful...</span></span>
<span id="cb1-10"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-11"><a href=""></a><span class="co">#' This function automatically adds the following to your link:</span></span>
<span id="cb1-12"><a href=""></a><span class="co">#' * `target="_blank"` to open in new tab</span></span>
<span id="cb1-13"><a href=""></a><span class="co">#' * `rel="noopener noreferrer"` to prevent [reverse tabnabbing](</span></span>
<span id="cb1-14"><a href=""></a><span class="co">#' https://owasp.org/www-community/attacks/Reverse_Tabnabbing)</span></span>
<span id="cb1-15"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-16"><a href=""></a><span class="co">#' By default this function also adds "(opens in new tab)" to your link text</span></span>
<span id="cb1-17"><a href=""></a><span class="co">#' to warn users of the behaviour.</span></span>
<span id="cb1-18"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-19"><a href=""></a><span class="co">#' This also adds "This link opens in a new tab" as a visually hidden span</span></span>
<span id="cb1-20"><a href=""></a><span class="co">#' element within the HTML outputted to warn non-visual users of the behaviour.</span></span>
<span id="cb1-21"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-22"><a href=""></a><span class="co">#' The function will error if you end with a full stop, give a warning for</span></span>
<span id="cb1-23"><a href=""></a><span class="co">#' particularly short link text and will automatically trim any leading or</span></span>
<span id="cb1-24"><a href=""></a><span class="co">#' trailing white space inputted into link_text.</span></span>
<span id="cb1-25"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-26"><a href=""></a><span class="co">#' If you are displaying lots of links together and want to save space by</span></span>
<span id="cb1-27"><a href=""></a><span class="co">#' avoiding repeating (opens in new tab), then you can set add_warning = FALSE</span></span>
<span id="cb1-28"><a href=""></a><span class="co">#' and add a line of text above all of the links saying something like 'The</span></span>
<span id="cb1-29"><a href=""></a><span class="co">#' following links open in a new tab'.</span></span>
<span id="cb1-30"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-31"><a href=""></a><span class="co">#' Related links and guidance:</span></span>
<span id="cb1-32"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-33"><a href=""></a><span class="co">#' * [Government digital services guidelines on the use of links](</span></span>
<span id="cb1-34"><a href=""></a><span class="co">#' https://design-system.service.gov.uk/styles/links/)</span></span>
<span id="cb1-35"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-36"><a href=""></a><span class="co">#' * [Anchor tag HTML element and its properties](</span></span>
<span id="cb1-37"><a href=""></a><span class="co">#' https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a)</span></span>
<span id="cb1-38"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-39"><a href=""></a><span class="co">#' * [WCAG 2.2 success criteria 2.4.4: Link Purpose (In Context)](</span></span>
<span id="cb1-40"><a href=""></a><span class="co">#' https://www.w3.org/WAI/WCAG22/Understanding/link-purpose-in-context)</span></span>
<span id="cb1-41"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-42"><a href=""></a><span class="co">#' * [Web Accessibility standards link text behaviour](</span></span>
<span id="cb1-43"><a href=""></a><span class="co">#' https://www.w3.org/TR/WCAG20-TECHS/G200.html)</span></span>
<span id="cb1-44"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-45"><a href=""></a><span class="co">#' @param href URL that you want the link to point to</span></span>
<span id="cb1-46"><a href=""></a><span class="co">#' @param link_text Text that will appear describing your link, must be</span></span>
<span id="cb1-47"><a href=""></a><span class="co">#' descriptive of the page you are linking to. Vague text like 'click here' or</span></span>
<span id="cb1-48"><a href=""></a><span class="co">#' 'here' will cause an error, as will ending in a full stop. Leading and</span></span>
<span id="cb1-49"><a href=""></a><span class="co">#' trailing white space will be automatically trimmed. If the string is shorter</span></span>
<span id="cb1-50"><a href=""></a><span class="co">#' than 7 characters a console warning will be thrown. There is no way to hush</span></span>
<span id="cb1-51"><a href=""></a><span class="co">#' this other than providing more detail.</span></span>
<span id="cb1-52"><a href=""></a><span class="co">#' @param add_warning Boolean for adding "(opens in new tab)" at the end of the</span></span>
<span id="cb1-53"><a href=""></a><span class="co">#' link text to warn users of the behaviour. Be careful and consider</span></span>
<span id="cb1-54"><a href=""></a><span class="co">#' accessibility before removing the visual warning.</span></span>
<span id="cb1-55"><a href=""></a><span class="co">#' @return shiny.tag object</span></span>
<span id="cb1-56"><a href=""></a><span class="co">#' @export</span></span>
<span id="cb1-57"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-58"><a href=""></a><span class="co">#' @examples</span></span>
<span id="cb1-59"><a href=""></a><span class="co">#' external_link("https://shiny.posit.co/", "R Shiny")</span></span>
<span id="cb1-60"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-61"><a href=""></a><span class="co">#' external_link(</span></span>
<span id="cb1-62"><a href=""></a><span class="co">#'   "https://shiny.posit.co/",</span></span>
<span id="cb1-63"><a href=""></a><span class="co">#'   "R Shiny",</span></span>
<span id="cb1-64"><a href=""></a><span class="co">#'   add_warning = FALSE</span></span>
<span id="cb1-65"><a href=""></a><span class="co">#' )</span></span>
<span id="cb1-66"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-67"><a href=""></a><span class="co">#' # This will trim and show as 'R Shiny'</span></span>
<span id="cb1-68"><a href=""></a><span class="co">#' external_link("https://shiny.posit.co/", "  R Shiny")</span></span>
<span id="cb1-69"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-70"><a href=""></a><span class="co">#' # Example of within text</span></span>
<span id="cb1-71"><a href=""></a><span class="co">#' shiny::tags$p(</span></span>
<span id="cb1-72"><a href=""></a><span class="co">#'   "Oi, ", external_link("https://shiny.posit.co/", "R Shiny"), " is great."</span></span>
<span id="cb1-73"><a href=""></a><span class="co">#' )</span></span>
<span id="cb1-74"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-75"><a href=""></a><span class="co">#' # Example of multiple links together</span></span>
<span id="cb1-76"><a href=""></a><span class="co">#' shiny::tags$h2("Related resources")</span></span>
<span id="cb1-77"><a href=""></a><span class="co">#' shiny::tags$p("The following links open in a new tab.")</span></span>
<span id="cb1-78"><a href=""></a><span class="co">#' shiny::tags$ul(</span></span>
<span id="cb1-79"><a href=""></a><span class="co">#'   shiny::tags$li(</span></span>
<span id="cb1-80"><a href=""></a><span class="co">#'     external_link(</span></span>
<span id="cb1-81"><a href=""></a><span class="co">#'       "https://shiny.posit.co/",</span></span>
<span id="cb1-82"><a href=""></a><span class="co">#'       "R Shiny documentation",</span></span>
<span id="cb1-83"><a href=""></a><span class="co">#'       add_warning = FALSE</span></span>
<span id="cb1-84"><a href=""></a><span class="co">#'     )</span></span>
<span id="cb1-85"><a href=""></a><span class="co">#'   ),</span></span>
<span id="cb1-86"><a href=""></a><span class="co">#'   shiny::tags$li(</span></span>
<span id="cb1-87"><a href=""></a><span class="co">#'     external_link(</span></span>
<span id="cb1-88"><a href=""></a><span class="co">#'       "https://www.python.org/",</span></span>
<span id="cb1-89"><a href=""></a><span class="co">#'       "Python documentation",</span></span>
<span id="cb1-90"><a href=""></a><span class="co">#'       add_warning = FALSE</span></span>
<span id="cb1-91"><a href=""></a><span class="co">#'     )</span></span>
<span id="cb1-92"><a href=""></a><span class="co">#'   ),</span></span>
<span id="cb1-93"><a href=""></a><span class="co">#'   shiny::tags$li(</span></span>
<span id="cb1-94"><a href=""></a><span class="co">#'     external_link(</span></span>
<span id="cb1-95"><a href=""></a><span class="co">#'       "https://nextjs.org/",</span></span>
<span id="cb1-96"><a href=""></a><span class="co">#'       "Next.js documentation",</span></span>
<span id="cb1-97"><a href=""></a><span class="co">#'       add_warning = FALSE</span></span>
<span id="cb1-98"><a href=""></a><span class="co">#'     )</span></span>
<span id="cb1-99"><a href=""></a><span class="co">#'   )</span></span>
<span id="cb1-100"><a href=""></a><span class="co">#' )</span></span>
<span id="cb1-101"><a href=""></a><span class="co">#'</span></span>
<span id="cb1-102"><a href=""></a>external_link <span class="ot">&lt;-</span> <span class="cf">function</span>(href, link_text, <span class="at">add_warning =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb1-103"><a href=""></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.logical</span>(add_warning)) {</span>
<span id="cb1-104"><a href=""></a>    <span class="fu">stop</span>(<span class="st">"add_warning must be a TRUE or FALSE value"</span>)</span>
<span id="cb1-105"><a href=""></a>  }</span>
<span id="cb1-106"><a href=""></a></span>
<span id="cb1-107"><a href=""></a>  <span class="co"># Trim white space as I don't trust humans not to accidentally include</span></span>
<span id="cb1-108"><a href=""></a>  link_text <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_trim</span>(link_text)</span>
<span id="cb1-109"><a href=""></a></span>
<span id="cb1-110"><a href=""></a>  <span class="co"># Create a basic check for raw URLs</span></span>
<span id="cb1-111"><a href=""></a>  is_url <span class="ot">&lt;-</span> <span class="cf">function</span>(text) {</span>
<span id="cb1-112"><a href=""></a>    url_pattern <span class="ot">&lt;-</span> <span class="st">"^(https://|http://|www</span><span class="sc">\\</span><span class="st">.)"</span></span>
<span id="cb1-113"><a href=""></a>    <span class="fu">grepl</span>(url_pattern, text)</span>
<span id="cb1-114"><a href=""></a>  }</span>
<span id="cb1-115"><a href=""></a></span>
<span id="cb1-116"><a href=""></a>  <span class="co"># Check for vague link text on our list</span></span>
<span id="cb1-117"><a href=""></a>  <span class="cf">if</span> (<span class="fu">is_url</span>(link_text)) {</span>
<span id="cb1-118"><a href=""></a>    <span class="fu">stop</span>(<span class="fu">paste0</span>(</span>
<span id="cb1-119"><a href=""></a>      link_text,</span>
<span id="cb1-120"><a href=""></a>      <span class="st">" has been recognised as a raw URL, please change the link_text value"</span>,</span>
<span id="cb1-121"><a href=""></a>      <span class="st">"to a description of the page being linked to instead"</span></span>
<span id="cb1-122"><a href=""></a>    ))</span>
<span id="cb1-123"><a href=""></a>  }</span>
<span id="cb1-124"><a href=""></a></span>
<span id="cb1-125"><a href=""></a>  <span class="co"># Check against curated data set for link text we should banish into room 101</span></span>
<span id="cb1-126"><a href=""></a>  <span class="cf">if</span> (<span class="fu">tolower</span>(link_text) <span class="sc">%in%</span> dfeshiny<span class="sc">::</span>bad_link_text<span class="sc">$</span>bad_link_text) {</span>
<span id="cb1-127"><a href=""></a>    <span class="fu">stop</span>(</span>
<span id="cb1-128"><a href=""></a>      <span class="fu">paste0</span>(</span>
<span id="cb1-129"><a href=""></a>        link_text,</span>
<span id="cb1-130"><a href=""></a>        <span class="st">" is not descriptive enough and has has been recognised as bad link"</span>,</span>
<span id="cb1-131"><a href=""></a>        <span class="st">" text, please replace the link_text argument with more descriptive"</span>,</span>
<span id="cb1-132"><a href=""></a>        <span class="st">" text."</span></span>
<span id="cb1-133"><a href=""></a>      )</span>
<span id="cb1-134"><a href=""></a>    )</span>
<span id="cb1-135"><a href=""></a>  }</span>
<span id="cb1-136"><a href=""></a></span>
<span id="cb1-137"><a href=""></a>  <span class="co"># Check if link text ends in a full stop</span></span>
<span id="cb1-138"><a href=""></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">.$"</span>, link_text)) {</span>
<span id="cb1-139"><a href=""></a>    <span class="fu">stop</span>(<span class="st">"link_text should not end with a full stop"</span>)</span>
<span id="cb1-140"><a href=""></a>  }</span>
<span id="cb1-141"><a href=""></a></span>
<span id="cb1-142"><a href=""></a>  <span class="co"># Give a console warning if link text is under 7 characters</span></span>
<span id="cb1-143"><a href=""></a>  <span class="co"># Arbritary number that allows for R Shiny to be link text without a warning</span></span>
<span id="cb1-144"><a href=""></a>  <span class="cf">if</span> (<span class="fu">nchar</span>(link_text) <span class="sc">&lt;</span> <span class="dv">7</span>) {</span>
<span id="cb1-145"><a href=""></a>    <span class="fu">warning</span>(<span class="fu">paste0</span>(</span>
<span id="cb1-146"><a href=""></a>      <span class="st">"the link_text: "</span>, link_text, <span class="st">", is shorter than 7 characters, this is"</span>,</span>
<span id="cb1-147"><a href=""></a>      <span class="st">" unlikely to be descriptive for users, consider having more detailed"</span>,</span>
<span id="cb1-148"><a href=""></a>      <span class="st">" link text"</span></span>
<span id="cb1-149"><a href=""></a>    ))</span>
<span id="cb1-150"><a href=""></a>  }</span>
<span id="cb1-151"><a href=""></a></span>
<span id="cb1-152"><a href=""></a>  <span class="co"># Assuming all else has passed, make the link text a nice accessible link</span></span>
<span id="cb1-153"><a href=""></a>  <span class="cf">if</span> (add_warning) {</span>
<span id="cb1-154"><a href=""></a>    link_text <span class="ot">&lt;-</span> <span class="fu">paste</span>(link_text, <span class="st">"(opens in new tab)"</span>)</span>
<span id="cb1-155"><a href=""></a>    hidden_span <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># don't have extra hidden text if clear in main text</span></span>
<span id="cb1-156"><a href=""></a>  } <span class="cf">else</span> {</span>
<span id="cb1-157"><a href=""></a>    hidden_span <span class="ot">&lt;-</span></span>
<span id="cb1-158"><a href=""></a>      htmltools<span class="sc">::</span><span class="fu">span</span>(<span class="at">class =</span> <span class="st">"sr-only"</span>, <span class="st">" (opens in new tab)"</span>)</span>
<span id="cb1-159"><a href=""></a>  }</span>
<span id="cb1-160"><a href=""></a></span>
<span id="cb1-161"><a href=""></a>  <span class="co"># Create the link object</span></span>
<span id="cb1-162"><a href=""></a>  link <span class="ot">&lt;-</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">a</span>(</span>
<span id="cb1-163"><a href=""></a>    <span class="at">href =</span> href,</span>
<span id="cb1-164"><a href=""></a>    htmltools<span class="sc">::</span><span class="fu">HTML</span>(<span class="fu">paste0</span>(link_text, hidden_span)), <span class="co"># white space hack</span></span>
<span id="cb1-165"><a href=""></a>    <span class="at">target =</span> <span class="st">"_blank"</span>,</span>
<span id="cb1-166"><a href=""></a>    <span class="at">rel =</span> <span class="st">"noopener noreferrer"</span>,</span>
<span id="cb1-167"><a href=""></a>    <span class="at">.noWS =</span> <span class="fu">c</span>(<span class="st">"outside"</span>)</span>
<span id="cb1-168"><a href=""></a>  )</span>
<span id="cb1-169"><a href=""></a></span>
<span id="cb1-170"><a href=""></a>  <span class="co"># Attach CSS from inst/www/css/visually-hidden.css</span></span>
<span id="cb1-171"><a href=""></a>  dependency <span class="ot">&lt;-</span> htmltools<span class="sc">::</span><span class="fu">htmlDependency</span>(</span>
<span id="cb1-172"><a href=""></a>    <span class="at">name =</span> <span class="st">"sr-only"</span>,</span>
<span id="cb1-173"><a href=""></a>    <span class="at">version =</span> <span class="fu">as.character</span>(utils<span class="sc">::</span><span class="fu">packageVersion</span>(<span class="st">"dfeshiny"</span>)[[<span class="dv">1</span>]]),</span>
<span id="cb1-174"><a href=""></a>    <span class="at">src =</span> <span class="fu">c</span>(<span class="at">href =</span> <span class="st">"dfeshiny/css"</span>),</span>
<span id="cb1-175"><a href=""></a>    <span class="at">stylesheet =</span> <span class="st">"sr-only.css"</span></span>
<span id="cb1-176"><a href=""></a>  )</span>
<span id="cb1-177"><a href=""></a></span>
<span id="cb1-178"><a href=""></a>  <span class="co"># Return the link with the CSS attached</span></span>
<span id="cb1-179"><a href=""></a>  <span class="fu">return</span>(htmltools<span class="sc">::</span><span class="fu">attachDependencies</span>(link, dependency, <span class="at">append =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-180"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="dfeshiny-package-2" class="slide level2">
<h2>dfeshiny package</h2>
<p>Simple example - created a function for accessible and secure links that open in new tabs, analysts don’t need to worry about the markup, just the content!</p>
<p>Code to create a custom list of ‘bad’ link text to validate against in that function</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>bad_link_text <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-2"><a href=""></a>  <span class="at">bad_link_text =</span> <span class="fu">c</span>(</span>
<span id="cb2-3"><a href=""></a>    <span class="co"># one word examples</span></span>
<span id="cb2-4"><a href=""></a>    <span class="st">"click"</span>, <span class="st">"csv"</span>, <span class="st">"continue"</span>, <span class="st">"dashboard"</span>, <span class="st">"document"</span>, <span class="st">"download"</span>, <span class="st">"file"</span>,</span>
<span id="cb2-5"><a href=""></a>    <span class="st">"form"</span>, <span class="st">"guidance"</span>, <span class="st">"here"</span>, <span class="st">"info"</span>, <span class="st">"information"</span>, <span class="st">"jpeg"</span>, <span class="st">"jpg"</span>, <span class="st">"learn"</span>,</span>
<span id="cb2-6"><a href=""></a>    <span class="st">"link"</span>, <span class="st">"more"</span>, <span class="st">"next"</span>, <span class="st">"page"</span>, <span class="st">"pdf"</span>, <span class="st">"previous"</span>, <span class="st">"read"</span>, <span class="st">"site"</span>, <span class="st">"svg"</span>,</span>
<span id="cb2-7"><a href=""></a>    <span class="st">"this"</span>, <span class="st">"web"</span>, <span class="st">"webpage"</span>, <span class="st">"website"</span>, <span class="st">"word"</span>, <span class="st">"xslx"</span>,</span>
<span id="cb2-8"><a href=""></a>    <span class="co"># two word examples</span></span>
<span id="cb2-9"><a href=""></a>    <span class="st">"click here"</span>, <span class="st">"click this link"</span>, <span class="st">"download csv"</span>, <span class="st">"download document"</span>,</span>
<span id="cb2-10"><a href=""></a>    <span class="st">"download file"</span>, <span class="st">"download here"</span>, <span class="st">"download jpg"</span>, <span class="st">"download jpeg"</span>,</span>
<span id="cb2-11"><a href=""></a>    <span class="st">"download pdf"</span>, <span class="st">"download png"</span>, <span class="st">"download svg"</span>, <span class="st">"download word"</span>,</span>
<span id="cb2-12"><a href=""></a>    <span class="st">"download xslx"</span>, <span class="st">"further information"</span>, <span class="st">"go here"</span>, <span class="st">"learn more"</span>,</span>
<span id="cb2-13"><a href=""></a>    <span class="st">"link to"</span>, <span class="st">"read more"</span>, <span class="st">"this page"</span>, <span class="st">"visit this"</span>, <span class="st">"web page"</span>, <span class="st">"web site"</span>,</span>
<span id="cb2-14"><a href=""></a>    <span class="st">"this link"</span></span>
<span id="cb2-15"><a href=""></a>  )</span>
<span id="cb2-16"><a href=""></a>)</span>
<span id="cb2-17"><a href=""></a></span>
<span id="cb2-18"><a href=""></a>usethis<span class="sc">::</span><span class="fu">use_data</span>(bad_link_text, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="dfeshiny-package-3" class="slide level2">
<h2>dfeshiny package</h2>
<p>Simple example - created a function for accessible and secure links that open in new tabs, analysts don’t need to worry about the markup, just the content!</p>
<p>CSS that we attach to the function</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource css number-lines code-with-copy"><code class="sourceCode css"><span id="cb3-1"><a href=""></a><span class="co">/* Taken from https://webaim.org/techniques/css/invisiblecontent/#:~:text=display%3Anone%20or%20visibility%3A%20hidden,is%20ignored%20by%20screen%20readers. */</span></span>
<span id="cb3-2"><a href=""></a><span class="fu">.sr-only</span> {</span>
<span id="cb3-3"><a href=""></a>  <span class="kw">position</span><span class="ch">:</span><span class="dv">absolute</span><span class="op">;</span></span>
<span id="cb3-4"><a href=""></a>  <span class="kw">left</span><span class="ch">:</span><span class="dv">-10000</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb3-5"><a href=""></a>  <span class="kw">top</span><span class="ch">:</span><span class="bu">auto</span><span class="op">;</span></span>
<span id="cb3-6"><a href=""></a>  <span class="kw">width</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb3-7"><a href=""></a>  <span class="kw">height</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb3-8"><a href=""></a>  <span class="kw">overflow</span><span class="ch">:</span><span class="dv">hidden</span><span class="op">;</span></span>
<span id="cb3-9"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="dfeshiny-package-4" class="slide level2">
<h2>dfeshiny package</h2>
<p>What an analyst sees</p>
<pre><code># One line of code
dfeshiny::external_link("https://www.gov.uk", "GOV.UK")

# Returns the following HTML
&lt;a href="https://www.gov.uk" target="_blank" rel="noopener noreferrer"&gt;GOV.UK (opens in new tab)&lt;/a&gt;

Warning message:
In dfeshiny::external_link("https://www.gov.uk", "GOV.UK") :
  the link_text: GOV.UK, is shorter than 7 characters, this is unlikely to be descriptive for users, consider having more detailed link text</code></pre>
<h3 id="weve-made-it-customisable">We’ve made it customisable</h3>
<p>We’ve also built in the option to remove the appending of (opens in new tab) using an <code>add_warning=</code> argument, this could be used if showing multiple links in a list with a separate warning about new tabs covering them all, in that case, it will still automatically add in a warning for screen readers who will lack the same visual context.</p>
<pre><code>dfeshiny::external_link("www.google.co.uk", "Google Search Engine", add_warning=FALSE)

&lt;a href="www.google.co.uk" target="_blank" rel="noopener noreferrer"&gt;Google Search Engine&lt;span class="sr-only"&gt; (opens in new tab)&lt;/span&gt;&lt;/a&gt;
</code></pre>
<p>The CSS for .sr-only class has been created in the package and attached automatically to the function behind the scenes.</p>
<h3 id="expanding-to-cover">Expanding to cover</h3>
<ul>
<li class="fragment"><p>Being able to write the logic and code in one place, and then everyone else (including across government) can benefit and speed up their development</p></li>
<li class="fragment"><p>Basic interactive charts (using ggplot2 and ggiraph) for hover and click events</p></li>
<li class="fragment"><p>Interactive maps using leaflet</p></li>
<li class="fragment"><p>Navigation - currently testing out a new left hand navigation component using links in a navigation container instead of tabs</p></li>
</ul>
</section>
<section id="shinygovstyle-package" class="slide level2">
<h2>shinyGovstyle package</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>Core GDS components built into R Shiny functions with styling using the GOV.UK frontend CSS</p></li>
<li class="fragment"><p>R package developed in MoJ, that had been archived in 2021, though I have recently revived it along with colleagues at HMRC and DHSC</p></li>
<li class="fragment"><p>We take static cuts of the GDS CSS on each update and attach into the package, attaching the classes to our custom functions and components, and log any changes we need to make to the CSS to make it work with R Shiny</p></li>
<li class="fragment"><p>One improvement we’ve made to the package is moving to use rem units for fonts (original package had a ‘rem-remover’ script as there used to be issues with rem units and R Shiny styling)</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/shinygovstyle.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</section>
<section id="shinygovstyle-package-1" class="slide level2">
<h2>shinyGovstyle package</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/shinygovstyle_examples.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div><div class="column" style="width:&quot;65%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/shinygovstylecss.png" class="quarto-figure quarto-figure-center" style="width:120.0%"></p>
</figure>
</div>
</div></div>
</section>
<section id="deployments" class="slide level2">
<h2>Deployments</h2>
<p>All dashboard deployments are done using GitHub Actions, we manage this for teams</p>
<p>Every time a commit is pushed to the main branch (or a pull request is merged in), a new deployment is triggered</p>
<p><a href="https://github.com/dfe-analytical-services/shiny-template/blob/main/.github/workflows/deploy-shiny.yaml">Example workflow file in our R Shiny template</a> - <code>.github/workflows/deploy-shiny.yaml</code></p>
<pre><code>on:
  push:
    branches:
      - main
      - development

name: shinyapps.io deploy

jobs:
  deployShiny:
    runs-on: ubuntu-latest
    
    env:
      GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}

    steps:
      - uses: actions/checkout@v4

      - uses: r-lib/actions/setup-r@v2
        with:
          use-public-rspm: true

      - name: Set env vars (dev)
        if: endsWith(github.ref, '/development')
        run: |
          echo "SHINYAPP_NAME='dev-dfe-shiny-template'" &gt;&gt; $GITHUB_ENV
          echo "SHINYAPP_OVERFLOW_NAME='dev-dfe-shiny-template-overflow'"&gt;&gt; $GITHUB_ENV
      - name: Set env vars (prod)
        if: endsWith(github.ref, '/main')
        run: |
          echo "SHINYAPP_NAME='dfe-shiny-template'"&gt;&gt; $GITHUB_ENV
          echo "SHINYAPP_OVERFLOW_NAME='dfe-shiny-template-overflow'"&gt;&gt; $GITHUB_ENV
        
      - name: Restore renv snapshot
        shell: Rscript {0}
        run: |
          if (!requireNamespace("renv", quietly = TRUE)) install.packages("renv")
          renv::restore()
          
      - name: Install rsconnect
        shell: Rscript {0}
        run: |
          if (!requireNamespace("renv", quietly = TRUE)) install.packages("renv")
          renv::install("rsconnect")
         
# Tokens are stored as secrets in GitHub to make sure only DfE analysts can publish apps in our shiny.io area
# Navigate to Settings &gt; Secrets to add and view secrets. These can also be things like admin login and passwords for SQL databases.
# Get in touch with the Explore education statistics platforms team if you need to add the below secrets to publish to shinyapps.io
          
      - name: Push to shiny.io
        run: &gt;
          Rscript
          -e "rsconnect::setAccountInfo(name = 'department-for-education', token = '${{secrets.SHINYAPPS_TOKEN}}', secret = '${{secrets.SHINYAPPS_SECRET}}')"
          -e "rsconnect::deployApp(appName=${{env.SHINYAPP_NAME}}, forceUpdate = TRUE)"
          -e "rsconnect::deployApp(appName=${{env.SHINYAPP_OVERFLOW_NAME}}, forceUpdate = TRUE)"</code></pre>
<p>We own the subscription and the tokens / secrets needed to deploy, so only our team can authorise new deployments</p>
</section>
<section id="estimated-timeframes-for-development" class="slide level2">
<h2>Estimated timeframes for development</h2>
<p>As an experiment we built a new dashboard from scratch to deployment in 30 mins using our template in a live coding session for a statisticians away day, which highlights the speed that development can happen at!</p>
<p>Recently, we’ve been gathering inputs from a range of analysts working with R Shiny across DfE and other departments and come up with this table of rough estimates for development timelines.</p>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/development_time.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
<ul>
<li class="fragment">Our aim is through improving our support offer, not only can we improve quality and consistency, we can reduce these times by as much as half</li>
</ul>
</section>
<section id="accessibility-testing-and-guidance" class="slide level2">
<h2>Accessibility testing and guidance</h2>
<p>We submit the core EES site for a full accessibility audit each year, retesting our changes 6 months later.</p>
<p>In our latest one we extended it to include our R Shiny template, and 2 public shiny dashboards too. This tests with multiple users of different accessibility needs using both desktop and mobile devices and provides a comprehensive report for any areas that fail.</p>
<div class="box">
<p><img data-src="images/dac-testing.png" style="width:65.0%"></p>
</div>
<p>We were lucky enough to visit the <a href="https://www.digitalaccessibilitycentre.org/">Digital Accessibility Centre (DAC)</a> during the testing window and were able to speak to the testers as they were carrying out our audit and see their experiences first hand.</p>
</section>
<section id="accessibility-resources-list" class="slide level2">
<h2>Accessibility resources list</h2>
<p>We’ve started a list on our analysts guide pointing to helpful <a href="https://dfe-analytical-services.github.io/analysts-guide/learning-development/accessibility.html">accessibility resources</a>. We also are proud to have two DfE accessibility champions in our area! (as well as many others who generally champion accessibility!)</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="free-tools-we-commonly-use">Free tools we commonly use</h3>
<ul>
<li class="fragment"><p><a href="https://chromewebstore.google.com/detail/axe-devtools-web-accessib/lhdoppojpmngadmnindnejefpokejbdd?pli=1">axe DevTools</a>, free Google Chrome extension, we recommend this for quick scans of markup on pages</p></li>
<li class="fragment"><p>Google Lighthouse, built into Google Chrome browser, and will catch some basic accessibility things amongst other web related issues</p></li>
<li class="fragment"><p>Windows Magnifier</p></li>
<li class="fragment"><p>NVDA screen reader</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/axe_devtools.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</div>
</section>
<section id="bookmarklets" class="slide level2">
<h2>Bookmarklets</h2>
<p>‘Bookmarklets’ are bookmarks that instead of saving a URL to a page, save a piece of Javascript code that executes on the page you are looking at.</p>
<p>There’s some nice <a href="https://design.education.gov.uk/accessibility/assurance">accessibility focused bookmarklets on the DfE design manual</a> that highlight specific types of mark up such as headers and lists so you can easily check if it matches what you’d expect while on any webpage. Very nifty and low effort too!</p>
<div class="box">
<p><img data-src="images/bookmarklets.png" class="quarto-figure quarto-figure-center" style="width:70.0%">f</p>
</div>
</section>
<section id="how-do-we-review-dashboards" class="slide level2">
<h2>How do we review dashboards?</h2>
<h3 id="our-own-review-process">Our own review process</h3>
<div class="fragment">
<p>For accessibility specifically we check:</p>
</div>
<ul>
<li class="fragment"><p>Markup is semantic, aria roles are used correctly, colour contrast, using axe devtools</p></li>
<li class="fragment"><p>Check keyboard navigation can reach all features and is in a logical order, check there’s a skip to main content link</p></li>
<li class="fragment"><p>Using the free NVDA download, check navigation with a screen reader</p></li>
<li class="fragment"><p>Use Windows Magnifier to check the page is usable at higher zoom levels and colour inversions</p></li>
<li class="fragment"><p>Link text is descriptive and appropriate</p></li>
<li class="fragment"><p>Download file accessibility (<a href="https://analysisfunction.civilservice.gov.uk/policy-store/making-spreadsheets-accessible-a-brief-checklist-of-the-basics/">spreadsheets checklist</a>)</p></li>
<li class="fragment"><p>Responsiveness on mobile devices, and zoom up to 400% without content spill</p></li>
<li class="fragment"><p>Our core components are used, and are using the latest versions (e.g.&nbsp;cookie consent)</p></li>
<li class="fragment"><p>Plus anything else we’ve had flagged in past external audits!</p></li>
<li class="fragment"><p>Anything that is a problem we either help the team to fix immediately, or log in the statement and create a public backlog for in GitHub that the team continues to work on after initial publication</p></li>
</ul>
<div class="fragment">
<h3 id="periodic-larger-audits">Periodic larger audits</h3>
</div>
<div class="fragment">
<p>We also do less frequent, larger checks on key user journeys and new components…</p>
</div>
<ul>
<li class="fragment"><p>Use an agency like <a href="https://www.digitalaccessibilitycentre.org/">Digital Accessibility Centre (DAC)</a> to thoroughly test with real users at least once a year</p></li>
<li class="fragment"><p>Use the empathy lab in SPP to test with Dragon (paid voice control software we don’t have readily available in the team), and ZoomText (magnifying software for low vision)</p>
<ul>
<li class="fragment">we’ve been caught out by colour inverting being subtly different to what is built into Windows, we had one particular button almost completely disappeared in ZoomText that we’d never spotted in other software</li>
</ul></li>
</ul>
</section>
<section id="how-do-dashboards-work-with-gds-service-assessments" class="slide level2">
<h2>How do dashboards work with GDS service assessments?</h2>
<ul>
<li class="fragment"><p>We had initial conversations with GDS, who said we should treat dashboards as prototypes, gathering user feedback regularly, and then progress from there</p></li>
<li class="fragment"><p>Our strategy and guidance is based around the GDS service standard, taking from many of the numbered points of the standard</p></li>
<li class="fragment"><p>As a dashboard can be created and published in weeks (or even days!), we’ve prioritised getting dashboards out quickly and being user led in their design over a more formal service assessment process</p></li>
<li class="fragment"><p>Currently we assess dashboards for suitability internally and then work with teams to publish and iterate on them</p></li>
<li class="fragment"><p>We should have new and improve servers in the new year for better logging and scaling to demand, as a part of this move we want to do a big sweep of some of the old dashboards, decommissioning and updating to the latest standards</p></li>
<li class="fragment"><p>We want to revisit this with GDS things have settled down next year</p></li>
</ul>
<div class="fragment">
<h3 id="we-treat-each-dashboard-is-a-digital-service-in-its-own-right">We treat each dashboard is a digital service in its own right</h3>
</div>
<ul>
<li class="fragment"><p>my motto to encourage analysts to engage with the GDS service standards</p></li>
<li class="fragment"><p>each dashboard must have a clearly defined user need</p></li>
<li class="fragment"><p>each dashboard must have its own accessibility statement</p></li>
<li class="fragment"><p>each dashboard has its own individual review, and business contacts</p></li>
</ul>
</section>
<section id="what-next" class="slide level2">
<h2>What next?</h2>
<ul>
<li class="fragment"><p>Working towards v1.0 of our template and supporting packages for dashboards</p></li>
<li class="fragment"><p>Do a big retrospective sweep of the old dashboards, making sure they all meet our latest standards</p></li>
<li class="fragment"><p>Next full external accessibility audit in Spring 2025</p></li>
<li class="fragment"><p>Aiming for live assessment of explore education statistics service Summer / Autumn 2025</p></li>
<li class="fragment"><p>Revisit our dashboard approach, exploring ways we could bring service assessments to dashboards</p></li>
<li class="fragment"><p>Continue to build the bridge between analysis and digital</p></li>
<li class="fragment"><p>Keen to hear if there’s any relevant contacts who might be helpful for us to talk to!</p></li>
</ul>
</section>
<section id="any-questions" class="slide level2 center-content">
<h2>Any questions?</h2>
<p>cameron.race@education.gov.uk</p>
<p><a href="">Slides hosted on GitHub</a> [coming soon…]</p>
<p><a href="https://github.com/dfe-analytical-services/public-dashboards-approach_20241128">Slides source code (GitHub)</a></p>
</section>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="images/DfE_logo_landscape.svg" class="slide-logo"></p>
<div class="footer footer-default">
<p>Our accessible statistics services journey (Nov 2024)</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: '120%',

        height: '120%',

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>